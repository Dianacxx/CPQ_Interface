<template>
    <!--DATATABLE START-->
    <!-- sldsValidatorIgnoreNextLine -->
    <template if:false={showLookupList}>
        <lightning-datatable key-field="Id" data={listToDisplay} columns={gridColumns}  hide-checkbox-column="true"  
        onrowaction={callRowAction} hide-table-header="true"></lightning-datatable>
    </template>
    <!--DATATABLE END-->
    <!--FILTERED POP-UP START-->
    <template if:true={openFilterPopup}>
        <section aria-modal="true" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container ">
                <header class="slds-modal__header">
                    <h2 class="slds-text-heading_medium slds-hyphenate">Filter & Select: {trackList.lookupCode}</h2>
                    <lightning-icon class="slds-modal__close" icon-name="utility:close" size="small" onclick={closeFilterAndSelected}></lightning-icon>
                </header>
                <div class="slds-modal__content">
                    <div class="slds-var-p-around_small slds-align_absolute-center slds-var-m-left_large">
                        <lightning-tabset active-tab-value={activeFilterTab}>
                            <!--FILTER TAB START-->
                            <lightning-tab label="Filter" value="Filter" onactive={handleFilterTabActive}>
                                <!--FILTERS REQUIRED START-->
                                <div class="slds-grid slds-gutters slds-var-m-bottom_small slds-var-m-left_large slds-var-m-right_small">
                                    <template if:true={productTypeShow}>
                                        <lightning-layout multiple-rows="false">
                                            <template for:each={productType} for:item="productType1">
                                                <lightning-combobox class="slds-var-m-right_xx-small" label={productType1.label} key={productType1.label} 
                                                options={productType1.options} onchange={handleProductTypeChange}></lightning-combobox>
                                            </template>
                                        </lightning-layout>
                                    </template>                                
                                </div>
                                <!--FILTERS REQUIRED END-->
                                <!--FILTERS DEPENDENCIES START-->
                                <div class="slds-grid slds-gutters slds-var-m-bottom_small slds-var-m-left_large slds-var-m-right_small">
                                    <lightning-spinner if:false={filtersLoading} alternative-text="Loading" size="small"></lightning-spinner>
                                    <template if:true={filtersLoading}>
                                        <lightning-layout multiple-rows="false">
                                            <template for:each={listFilters} for:item="comboboxFilters">
                                                <lightning-combobox class="slds-var-m-right_x-small" key={comboboxFilters.label} label={comboboxFilters.label} value={comboboxFilters.value}
                                                options={comboboxFilters.options} onchange={handleInputChange}></lightning-combobox>
                                            </template>
                                            <template for:each={listTextFilters} for:item="textFilters">
                                                <lightning-input class="slds-var-m-right_x-small" key={textFilters.label} name={textFilters.label} type="text" label={textFilters.label} 
                                                onchange={handleInputChange}></lightning-input>
                                            </template>
                                        </lightning-layout>
                                    </template>
                                </div>
                                <!--FILTERS DEPENDENCIES END-->
                                <!--CLEAR FILTERS START-->
                                <div class="slds-grid slds-gutters slds-var-m-left_large slds-align_absolute-center slds-var-m-right_small">
                                    <lightning-button variant="brand" label="Clear Filters" title="Clear"  onclick={clearFilters} class="slds-var-m-left_small slds-var-m-top_large"></lightning-button>
                                </div>
                                <!--CLEAR FILTERS END-->
                                <!--RECORDS FILTERED START-->
                                <div class="slds-grid slds-gutters slds-var-m-left_large slds-var-m-top_medium">
                                    <lightning-icon icon-name="standard:filter" alternative-text="filter" size="small" class=" slds-var-m-right_small"></lightning-icon>
                                    <p style="color: rgb(21, 35, 233); font-size:16px;">Filtered, {recordsAmount} records found.</p>
                                </div>
                                <!--RECORDS FILTERED END-->
                                <div>
                                    <lightning-spinner if:true={loadingFilteData} alternative-text="Loading" size="medium"></lightning-spinner>
                                    <!--PAGINATION CONTROL START-->
                                    <div>
                                        <p class="slds-align_absolute-center"><b> Page {page} of {totalPage}</b></p>
                                        <lightning-button-group class="slds-align_absolute-center">
                                            <lightning-button label="First" icon-name="utility:chevronleft" onclick={firstHandler} class="stretchButton"></lightning-button>
                                            <lightning-button label="Previous" icon-name="utility:chevronleft" onclick={previousHandler} class="stretchButton"></lightning-button>
                                            <lightning-button label="Next" icon-name="utility:chevronright" icon-position="right" onclick={nextHandler} class="stretchButton"></lightning-button>
                                            <lightning-button label="Last" icon-name="utility:chevronright" icon-position="right" onclick={lastHandler} class="stretchButton"></lightning-button>
                                        </lightning-button-group>
                                    </div>
                                    <!--PAGINATION CONTROL END-->
                                    <!--TABLE START-->
                                    <template if:true={filtersLoading}>
                                        <lightning-datatable key-field="Id" data={dataPages} columns={columnsFilters} onrowselection={handleRowSelection}>
                                        </lightning-datatable>
                                    </template>
                                    <!--TABLE END-->
                                </div>
                            </lightning-tab>
                            <!--FILTER TAB END-->
                            <!--REVIEW TAB START-->
                            <lightning-tab label="Review" value="Review" onactive={handleReviewTabActive}>
                                <template if:true={filtersLoading}> 
                                    <h2 class="slds-align_absolute-center slds-text-heading_medium slds-var-m-bottom_medium">
                                        Set attributes values for NSP(Non-Standard Product).
                                    </h2>                                   
                                    <!--RECORDS INFORMATION START-->
                                    <div class="slds-grid slds-gutters slds-var-m-left_large slds-var-m-top_medium">
                                        <lightning-icon icon-name="standard:filter" alternative-text="filter" size="small" class=" slds-var-m-right_small"></lightning-icon>
                                        <p style="color: rgb(21, 35, 233); font-size:16px;">Reviewing, {reviewDisplay.length} records.</p>
                                    </div>
                                    <!--RECORDS INFORMATION END-->
                                    <div>
                                        <!--PAGINATION CONTROL START-->
                                        <div>
                                            <p class="slds-align_absolute-center"><b> Page {pageR} of {totalPageR}</b></p>
                                            <lightning-button-group class="slds-align_absolute-center">
                                                <lightning-button label="First" icon-name="utility:chevronleft" onclick={firstHandlerR} class="stretchButton"></lightning-button>
                                                <lightning-button label="Previous" icon-name="utility:chevronleft" onclick={previousHandlerR} class="stretchButton"></lightning-button>
                                                <lightning-button label="Next" icon-name="utility:chevronright" icon-position="right" onclick={nextHandlerR} class="stretchButton"></lightning-button>
                                                <lightning-button label="Last" icon-name="utility:chevronright" icon-position="right" onclick={lastHandlerR} class="stretchButton"></lightning-button>
                                            </lightning-button-group>
                                        </div>
                                        <!--PAGINATION CONTROL END-->
                                        <lightning-spinner if:true={reviewLoading} alternative-text="Loading" size="small"></lightning-spinner>
                                        <!--RECORDS SELECTED TABLE START-->
                                        <template if:false={reviewLoading}>
                                            <lightning-datatable key-field="Id" data={dataPagesR} columns={columnsReview} hide-checkbox-column=true onrowaction={handleRowAction}
                                            draft-values={draftValues} onsave={handleSaveEditionReviewTable}>
                                            </lightning-datatable>
                                        </template>
                                        <!--RECORDS SELECTED TABLE END-->
                                    </div>
                                </template>
                            </lightning-tab>
                            <!--REVIEW TAB END-->
                        </lightning-tabset>
                    </div>
                </div>
                <footer class="slds-modal__footer">
                    <template if:false={tabOption}>
                        <lightning-button variant="brand" label="Cancel" title="Close"  onclick={closeFilterAndSelected} class="slds-var-m-right_small"></lightning-button>   
                        <lightning-button variant="brand" label="Add & Review" title="Add"  onclick={addAndReview} disabled={goReview}></lightning-button>    
                    </template>
                    <template if:true={tabOption}>
                        <lightning-button variant="brand" label="Add More" title="AddMore"  onclick={moreAdd} class="slds-var-m-right_small"></lightning-button>   
                        <lightning-button variant="brand" label="Save & Exit" title="SaveExit"  onclick={saveAndExitFilterModal} ></lightning-button>
                    </template>
                </footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>
    <!--FILTERED POP-UP END-->
    <!--CONFIGURED POP-UP START-->
    <template if:true={openConfiguredPopup}>
        <section aria-modal="true" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container ">
                <header class="slds-modal__header">
                    <h2 class="slds-text-heading_medium slds-hyphenate">Configured Product Alert</h2>
                    <lightning-icon class="slds-modal__close" icon-name="utility:close" size="small" onclick={closeConfiguredAlert}></lightning-icon>
                </header>
                <div class="slds-modal__content">
                    <div class="slds-var-p-around_medium lgc-bg slds-var-p-around_small slds-align_absolute-center">
                        <lightning-icon class="slds-var-m-right_small" icon-name="utility:warning" alternative-text="Warning!" title="Warning"></lightning-icon>
                        In order to redirect you to the Salesforce QLE configured product page for this product, the process in the UI is going to be saved right now in salesforce. Are you going to continue? 
                    </div>
                </div>
                <footer class="slds-modal__footer">
                    <lightning-button variant="brand" label="Cancel" title="Close"  onclick={closeConfiguredAlert} class="slds-var-m-right_small"></lightning-button>   
                    <lightning-button variant="brand" label="Continue" title="Continue"  onclick={continueConfiguredQLE} ></lightning-button>    
                </footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>
    <!--CONFIGURED POP-UP END-->
</template>