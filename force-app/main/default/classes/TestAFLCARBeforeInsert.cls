/*---=============================================================================
---                              AFL 
---
---       Program Name          : TestAFLCARBeforeInsert
---
---       Program Description   : This APEX class tests the Correction Action creation
---                               process.
---                          
---       Date Written          : 10/30/2015
---
---       Task Number           : W-001233
---
--------------------------------------------------------------------------------
---       Development And Modification History:
---
--- Task#     Ver# DATE     Developer     DESCRIPTION
--- --------  ---- -------- ------------- ------------------------------
--- W-001233  1.0  10/30/15 BHATNJA       Initial version
---
---       Copyright 2013 AFL 
---=============================================================================*/
@isTest public class TestAFLCARBeforeInsert {      
    
    static testMethod void AFLCARCreate_Test() {
        AFL_Generate_Auto_Number__c setting = new AFL_Generate_Auto_Number__c();
        setting.Name = 'Corrective_Action_Num_Sequence__c';
        setting.Corrective_Action_Num_Sequence__c = 1;
        insert setting;
        
        Test.startTest();
        
        Corrective_Action__c car = new Corrective_Action__c();      
        
        car.Problem_Statement__c = 'test problem statement';
        car.Business_Unit__c = 'ACA';
        car.Product_Group__c = 'Rail';
        car.Type__c = 'Documentation Only';
        car.Problem_Type__c = 'Admin Error';
        
        insert car;
        
        Test.stopTest();
        
        Corrective_Action__c dbCar = new Corrective_Action__c();
        
        dbCar = [select id, name from Corrective_Action__c where id = :car.Id];
        
        System.assertNotEquals(null, dbCar.Name, 'Correction Action Name was not generated by the trigger.');
    }
}